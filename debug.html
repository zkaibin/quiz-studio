<!DOCTYPE html>
<html>
<head>
    <title>Debug Quiz Studio</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        pre { background: white; padding: 15px; border-radius: 5px; overflow-x: auto; margin: 10px 0; border-left: 4px solid #ccc; }
        .success { border-left-color: green; }
        .error { border-left-color: red; }
        h2 { margin-top: 30px; }
    </style>
</head>
<body>
    <h1>Quiz Studio Debug Console</h1>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');
        const logs = [];
        
        function log(msg, isError = false) {
            logs.push({ msg, isError });
            const pre = document.createElement('pre');
            pre.className = isError ? 'error' : 'success';
            pre.textContent = msg;
            output.appendChild(pre);
            console.log(msg);
        }

        log('=== PAGE LOADED ===');
        log(`Timestamp: ${new Date().toISOString()}`);
        log(`URL: ${window.location.href}`);
        
        // Check 1: Scripts loaded
        log('\n=== CHECK 1: Global Objects ===');
        log(`typeof DataManager: ${typeof DataManager}`);
        log(`typeof dataManager: ${typeof dataManager}`);
        log(`typeof QuizApp: ${typeof QuizApp}`);
        log(`typeof quizApp: ${typeof quizApp}`);

        // Check 2: Data Manager contents
        if (typeof dataManager !== 'undefined') {
            log('\n=== CHECK 2: DataManager State ===');
            log(`dataManager.loaded: ${dataManager.loaded}`);
            log(`dataManager.data.questions.length: ${dataManager.data.questions.length}`);
            log(`dataManager.data.categories: ${JSON.stringify(dataManager.getCategories())}`);
            log(`dataManager.data.difficulties: ${JSON.stringify(dataManager.getDifficulties())}`);
        }

        // Check 3: Test fetching data directly
        log('\n=== CHECK 3: Direct Fetch Test ===');
        fetch('/quiz-studio/data/questions.json')
            .then(r => {
                log(`Fetch response status: ${r.status} ${r.statusText}`);
                return r.json();
            })
            .then(data => {
                log(`✓ Direct fetch SUCCESS: ${data.length} questions loaded`);
                log(`Categories found: ${Array.from(new Set(data.map(q => q.category))).join(', ')}`);
            })
            .catch(e => {
                log(`✗ Direct fetch FAILED: ${e.message}`, true);
            });

        // Check 4: Test QuizApp
        setTimeout(() => {
            log('\n=== CHECK 4: QuizApp Status ===');
            if (typeof quizApp !== 'undefined') {
                log(`✓ quizApp instance exists`);
                log(`quizApp.questions.length: ${quizApp.questions.length}`);
                
                // Test getting questions
                const allQuestions = dataManager.getQuestions('all', 'all');
                log(`getQuestions('all', 'all'): ${allQuestions.length} questions`);
                
                const marvelQuestions = dataManager.getQuestions('Marvel', 'all');
                log(`getQuestions('Marvel', 'all'): ${marvelQuestions.length} questions`);
            } else {
                log(`✗ quizApp instance NOT created`, true);
            }
        }, 2000);

        // Check 5: Check for errors in console
        window.addEventListener('error', (e) => {
            log(`\n⚠️ JavaScript Error: ${e.message}`, true);
            log(`At: ${e.filename}:${e.lineno}:${e.colno}`);
        });
    </script>

    <script src="/quiz-studio/js/data-loader.js"></script>
    <script src="/quiz-studio/js/quiz.js"></script>
</body>
</html>
